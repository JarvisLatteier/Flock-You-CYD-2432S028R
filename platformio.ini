[env:xiao_esp32s3]
platform = espressif32
board = seeed_xiao_esp32s3
framework = arduino
monitor_speed = 115200
board_build.partitions = huge_app.csv
board_build.flash_mode = qio
board_build.flash_size = 8MB
board_build.psram_type = opi
lib_deps = 
    h2zero/NimBLE-Arduino@^1.4.0
    bblanchon/ArduinoJson@^6.21.0
build_flags = 
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCONFIG_BT_NIMBLE_ENABLED=1

[env:xiao_esp32c3]
platform = espressif32
board = seeed_xiao_esp32c3
framework = arduino
monitor_speed = 115200
board_build.partitions = huge_app.csv
board_build.flash_mode = qio
board_build.flash_size = 4MB
board_build.psram_type = opi
lib_deps =
    h2zero/NimBLE-Arduino@^1.4.0
    bblanchon/ArduinoJson@^6.21.0
build_flags =
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCONFIG_BT_NIMBLE_ENABLED=1

[env:esp32_cyd_35]
platform = espressif32
board = esp32dev
framework = arduino
lib_ldf_mode = deep
monitor_speed = 115200
board_build.partitions = default.csv
board_build.flash_mode = qio
board_build.flash_size = 4MB
upload_speed = 115200
monitor_filters = esp32_exception_decoder

lib_deps =
    h2zero/NimBLE-Arduino@^1.4.0
    bblanchon/ArduinoJson@^6.21.0
    moononournation/GFX Library for Arduino@^1.4.7

build_src_filter = +<*> -<display_handler.cpp> +<display_handler_simple.cpp>

build_flags =
    -DARDUINO_USB_MODE=0
    -DARDUINO_USB_CDC_ON_BOOT=0
    -DCONFIG_BT_NIMBLE_ENABLED=1
    -DCYD_DISPLAY=1
    -DCORE_DEBUG_LEVEL=0
    -DARDUINO_RUNNING_CORE=1

    ; Display pins for Arduino_GFX (ST7796) - CORRECT PINS!
    -D TFT_DC=2
    -D TFT_CS=15
    -D TFT_RST=4
    -D TFT_BL=27
    -D BUS_SCK=14
    -D BUS_MOSI=13
    -D BUS_MISO=12

    ; Touch pins
    -D TOUCH_CS=33
    -D TOUCH_IRQ=36

    ; Display settings
    -D TFT_WIDTH=320
    -D TFT_HEIGHT=480
    -D TFT_ROTATION=0

[env:cyd_test]
platform = espressif32
board = esp32dev
framework = arduino
lib_ldf_mode = deep
monitor_speed = 115200
board_build.partitions = default.csv
board_build.flash_mode = qio
board_build.flash_size = 4MB
upload_speed = 115200

lib_deps =
    bodmer/TFT_eSPI@^2.5.43

build_flags =
    -DARDUINO_USB_MODE=0
    -DARDUINO_USB_CDC_ON_BOOT=0
    -DCORE_DEBUG_LEVEL=3

    ; TFT_eSPI Configuration for CYD
    -D USER_SETUP_LOADED=1
    -D ILI9341_DRIVER=1

    ; Alternative pin configuration for CYD
    -D TFT_MISO=19
    -D TFT_MOSI=23
    -D TFT_SCLK=18
    -D TFT_CS=15
    -D TFT_DC=2
    -D TFT_RST=4

    ; Display settings
    -D TFT_WIDTH=320
    -D TFT_HEIGHT=240
    -D TFT_ROTATION=1

    ; SPI Frequency
    -D SPI_FREQUENCY=27000000

    ; Font loading
    -D LOAD_GLCD=1
    -D LOAD_FONT2=1

[env:esp32_cyd_35_st7796]
platform = espressif32
board = esp32dev
framework = arduino
lib_ldf_mode = deep
monitor_speed = 115200
board_build.partitions = default.csv
board_build.flash_mode = qio
board_build.flash_size = 4MB
upload_speed = 115200
monitor_filters = esp32_exception_decoder

lib_deps =
    h2zero/NimBLE-Arduino@^1.4.0
    bblanchon/ArduinoJson@^6.21.0
    moononournation/GFX Library for Arduino@^1.4.7

build_flags =
    -DARDUINO_USB_MODE=0
    -DARDUINO_USB_CDC_ON_BOOT=0
    -DCONFIG_BT_NIMBLE_ENABLED=1
    -DCYD_DISPLAY=1
    -DCORE_DEBUG_LEVEL=0
    -DARDUINO_RUNNING_CORE=1

    ; Hosyond ST7796U pins (from working review)
    -D TFT_DC=2
    -D TFT_CS=15
    -D TFT_RST=4
    -D TFT_BL=27
    -D TOUCH_CS=33
    -D TOUCH_IRQ=36
    -D BUS_SCK=14
    -D BUS_MOSI=13
    -D BUS_MISO=12

    ; Display settings (480x320 landscape)
    -D TFT_WIDTH=480
    -D TFT_HEIGHT=320
    -D TFT_ROTATION=1

build_src_filter = +<*> -<display_handler.cpp> +<display_handler_simple.cpp>

[env:display_test]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 115200

lib_deps =
    moononournation/GFX Library for Arduino@^1.4.7

build_flags =
    -DARDUINO_USB_MODE=0
    -DARDUINO_USB_CDC_ON_BOOT=0

src_filter = +<*> -<main.cpp> -<display_handler.cpp> +<../test_display.cpp>

[env:esp32_cyd_28]
platform = espressif32
board = esp32dev
framework = arduino
lib_ldf_mode = deep
monitor_speed = 115200
board_build.partitions = default.csv
board_build.flash_mode = qio
board_build.flash_size = 4MB
upload_speed = 115200
monitor_filters = esp32_exception_decoder

lib_deps =
    h2zero/NimBLE-Arduino@^1.4.0
    bblanchon/ArduinoJson@^6.21.0
    bodmer/TFT_eSPI@^2.5.43

build_src_filter = +<main.cpp> +<display_handler_28.cpp>

build_flags =
    -DARDUINO_USB_MODE=0
    -DARDUINO_USB_CDC_ON_BOOT=0
    -DCONFIG_BT_NIMBLE_ENABLED=1
    -DCYD_DISPLAY=1
    -DCORE_DEBUG_LEVEL=0
    -DARDUINO_RUNNING_CORE=1

    ; TFT_eSPI Configuration for ESP32-2432S028R (ILI9341 320x240)
    -D USER_SETUP_LOADED=1
    -D ILI9341_DRIVER=1

    ; SPI pins (alternative mapping for this board)
    -D TFT_MISO=12
    -D TFT_MOSI=13
    -D TFT_SCLK=14
    -D TFT_CS=15
    -D TFT_DC=2
    -D TFT_RST=4

    ; Dual backlight pins
    -D TFT_BL=27
    -D TFT_BL2=21

    ; Touch controller (XPT2046) - SEPARATE HSPI bus!
    -D TOUCH_CS=33
    -D TOUCH_IRQ=36
    -D TOUCH_CLK=25
    -D TOUCH_MOSI=32
    -D TOUCH_MISO=39

    ; Display settings
    -D TFT_WIDTH=240
    -D TFT_HEIGHT=320

    ; BGR color order (critical for this display!)
    -D TFT_RGB_ORDER=TFT_BGR

    ; SPI Frequency (80MHz works per your testing)
    -D SPI_FREQUENCY=80000000
    -D SPI_READ_FREQUENCY=20000000
    -D SPI_TOUCH_FREQUENCY=2500000

    ; Font loading
    -D LOAD_GLCD=1
    -D LOAD_FONT2=1
    -D LOAD_FONT4=1
    -D SMOOTH_FONT=1

[env:esp32_cyd_28_headless]
platform = espressif32
board = esp32dev
framework = arduino
lib_ldf_mode = deep
monitor_speed = 115200
board_build.partitions = default.csv
board_build.flash_mode = qio
board_build.flash_size = 4MB
upload_speed = 115200
monitor_filters = esp32_exception_decoder

lib_deps =
    h2zero/NimBLE-Arduino@^1.4.0
    bblanchon/ArduinoJson@^6.21.0

build_src_filter = +<main.cpp>

build_flags =
    -DARDUINO_USB_MODE=0
    -DARDUINO_USB_CDC_ON_BOOT=0
    -DCONFIG_BT_NIMBLE_ENABLED=1
    -DCORE_DEBUG_LEVEL=0
    -DARDUINO_RUNNING_CORE=1

; ============================================================================
; Waveshare ESP32-S3-LCD-1.47 (172x320 ST7789, no touch)
; ============================================================================
[env:waveshare_s3_147]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
lib_ldf_mode = deep
monitor_speed = 115200
board_build.partitions = default.csv
board_build.flash_mode = qio
board_build.flash_size = 16MB
board_build.psram_type = opi
board_upload.flash_size = 16MB
upload_speed = 921600
monitor_filters = esp32_exception_decoder

lib_deps =
    h2zero/NimBLE-Arduino@^1.4.0
    bblanchon/ArduinoJson@^6.21.0
    bodmer/TFT_eSPI@^2.5.43
    fastled/FastLED@^3.6.0

build_src_filter = +<main.cpp> +<display_handler_147.cpp>

build_flags =
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCONFIG_BT_NIMBLE_ENABLED=1
    -DWAVESHARE_147=1
    -DCORE_DEBUG_LEVEL=0
    -DARDUINO_RUNNING_CORE=1
    -DBOARD_HAS_PSRAM=1

    ; TFT_eSPI Configuration for Waveshare ESP32-S3-LCD-1.47 (ST7789 172x320)
    -D USER_SETUP_LOADED=1
    -D ST7789_DRIVER=1

    ; SPI pins for Waveshare board
    -D TFT_MOSI=45
    -D TFT_SCLK=40
    -D TFT_CS=42
    -D TFT_DC=41
    -D TFT_RST=39
    -D TFT_BL=48

    ; Display settings (172x320 portrait)
    -D TFT_WIDTH=172
    -D TFT_HEIGHT=320

    ; RGB color order
    -D TFT_RGB_ORDER=TFT_RGB

    ; SPI Frequency
    -D SPI_FREQUENCY=80000000
    -D SPI_READ_FREQUENCY=20000000

    ; Font loading
    -D LOAD_GLCD=1
    -D LOAD_FONT2=1
    -D LOAD_FONT4=1
    -D SMOOTH_FONT=1

    ; RGB LED (WS2812 on GPIO 38)
    -D RGB_LED_PIN=38

    ; SD Card (SDMMC interface)
    -D SD_MMC_MODE=1
